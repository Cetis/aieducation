import{r as t,h as n,H as r,g as i}from"./p-68751d42.js";import{k as e,a as o,g as u,l as s,s as h}from"./p-56e73c83.js";import"./p-d9655876.js";import{f as a,l as c}from"./p-373b29c4.js";import{r as l}from"./p-1e7506b0.js";class f extends Map{constructor(t,n=p){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),null!=t)for(const[n,r]of t)this.set(n,r)}get(t){return super.get(d(this,t))}has(t){return super.has(d(this,t))}set(t,n){return super.set(function({_intern:t,_key:n},r){const i=n(r);return t.has(i)?t.get(i):(t.set(i,r),r)}(this,t),n)}delete(t){return super.delete(function({_intern:t,_key:n},r){const i=n(r);return t.has(i)&&(r=t.get(i),t.delete(i)),r}(this,t))}}function d({_intern:t,_key:n},r){const i=n(r);return t.has(i)?t.get(i):r}function p(t){return null!==t&&"object"==typeof t?t.valueOf():t}const v=Symbol("implicit");function M(){var t=new f,n=[],r=[],i=v;function e(e){let o=t.get(e);if(void 0===o){if(i!==v)return i;t.set(e,o=n.push(e)-1)}return r[o%r.length]}return e.domain=function(r){if(!arguments.length)return n.slice();n=[],t=new f;for(const i of r)t.has(i)||t.set(i,n.push(i)-1);return e},e.range=function(t){return arguments.length?(r=Array.from(t),e):r.slice()},e.unknown=function(t){return arguments.length?(i=t,e):i},e.copy=function(){return M(n,r).unknown(i)},a.apply(e,arguments),e}function g(){var t,n,r=M().unknown(void 0),i=r.domain,e=r.range,o=0,u=1,s=!1,h=0,c=0,f=.5;function d(){var r=i().length,a=u<o,d=a?u:o,p=a?o:u;t=(p-d)/Math.max(1,r-h+2*c),s&&(t=Math.floor(t)),d+=(p-d-t*(r-h))*f,n=t*(1-h),s&&(d=Math.round(d),n=Math.round(n));var v=l(r).map((function(n){return d+t*n}));return e(a?v.reverse():v)}return delete r.unknown,r.domain=function(t){return arguments.length?(i(t),d()):i()},r.range=function(t){return arguments.length?([o,u]=t,o=+o,u=+u,d()):[o,u]},r.rangeRound=function(t){return[o,u]=t,o=+o,u=+u,s=!0,d()},r.bandwidth=function(){return n},r.step=function(){return t},r.round=function(t){return arguments.length?(s=!!t,d()):s},r.padding=function(t){return arguments.length?(h=Math.min(1,c=+t),d()):h},r.paddingInner=function(t){return arguments.length?(h=Math.min(1,t),d()):h},r.paddingOuter=function(t){return arguments.length?(c=+t,d()):c},r.align=function(t){return arguments.length?(f=Math.max(0,Math.min(1,t)),d()):f},r.copy=function(){return g(i(),[o,u]).round(s).paddingInner(h).paddingOuter(c).align(f)},a.apply(d(),arguments)}const m=Math.PI,b=2*m,y=b-1e-6;function x(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function k(){return new x}function w(t){return function(){return t}}x.prototype=k.prototype={constructor:x,moveTo:function(t,n){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+n)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,n){this._+="L"+(this._x1=+t)+","+(this._y1=+n)},quadraticCurveTo:function(t,n,r,i){this._+="Q"+ +t+","+ +n+","+(this._x1=+r)+","+(this._y1=+i)},bezierCurveTo:function(t,n,r,i,e,o){this._+="C"+ +t+","+ +n+","+ +r+","+ +i+","+(this._x1=+e)+","+(this._y1=+o)},arcTo:function(t,n,r,i,e){var o=this._x1,u=this._y1,s=(r=+r)-(t=+t),h=(i=+i)-(n=+n),a=o-t,c=u-n,l=a*a+c*c;if((e=+e)<0)throw new Error("negative radius: "+e);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=n);else if(l>1e-6)if(Math.abs(c*s-h*a)>1e-6&&e){var f=r-o,d=i-u,p=s*s+h*h,v=f*f+d*d,M=Math.sqrt(p),g=Math.sqrt(l),b=e*Math.tan((m-Math.acos((p+l-v)/(2*M*g)))/2),y=b/g,x=b/M;Math.abs(y-1)>1e-6&&(this._+="L"+(t+y*a)+","+(n+y*c)),this._+="A"+e+","+e+",0,0,"+ +(c*f>a*d)+","+(this._x1=t+x*s)+","+(this._y1=n+x*h)}else this._+="L"+(this._x1=t)+","+(this._y1=n)},arc:function(t,n,r,i,e,o){t=+t,n=+n,o=!!o;var u=(r=+r)*Math.cos(i),s=r*Math.sin(i),h=t+u,a=n+s,c=1^o,l=o?i-e:e-i;if(r<0)throw new Error("negative radius: "+r);null===this._x1?this._+="M"+h+","+a:(Math.abs(this._x1-h)>1e-6||Math.abs(this._y1-a)>1e-6)&&(this._+="L"+h+","+a),r&&(l<0&&(l=l%b+b),l>y?this._+="A"+r+","+r+",0,1,"+c+","+(t-u)+","+(n-s)+"A"+r+","+r+",0,1,"+c+","+(this._x1=h)+","+(this._y1=a):l>1e-6&&(this._+="A"+r+","+r+",0,"+ +(l>=m)+","+c+","+(this._x1=t+r*Math.cos(e))+","+(this._y1=n+r*Math.sin(e))))},rect:function(t,n,r,i){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+n)+"h"+ +r+"v"+ +i+"h"+-r+"Z"},toString:function(){return this._}};var D=Math.abs,A=Math.atan2,_=Math.cos,j=Math.max,E=Math.min,F=Math.sin,L=Math.sqrt,C=Math.PI,T=C/2,B=2*C;function z(t){return t>1?0:t<-1?C:Math.acos(t)}function S(t){return t>=1?T:t<=-1?-T:Math.asin(t)}function W(t){return t.innerRadius}function U(t){return t.outerRadius}function Z(t){return t.startAngle}function q(t){return t.endAngle}function H(t){return t&&t.padAngle}function O(t,n,r,i,e,o,u,s){var h=r-t,a=i-n,c=u-e,l=s-o,f=l*h-c*a;if(!(f*f<1e-12))return[t+(f=(c*(n-o)-l*(t-e))/f)*h,n+f*a]}function P(t,n,r,i,e,o,u){var s=t-r,h=n-i,a=(u?o:-o)/L(s*s+h*h),c=a*h,l=-a*s,f=t+c,d=n+l,p=r+c,v=i+l,M=(f+p)/2,g=(d+v)/2,m=p-f,b=v-d,y=m*m+b*b,x=e-o,k=f*v-p*d,w=(b<0?-1:1)*L(j(0,x*x*y-k*k)),D=(k*b-m*w)/y,A=(-k*m-b*w)/y,_=(k*b+m*w)/y,E=(-k*m+b*w)/y,F=D-M,C=A-g,T=_-M,B=E-g;return F*F+C*C>T*T+B*B&&(D=_,A=E),{cx:D,cy:A,x01:-c,y01:-l,x11:D*(e/x-1),y11:A*(e/x-1)}}const Q=class{constructor(n){t(this,n),this.dataSrc=null,this.keys="@pillars",this.colours="#AF3845,#E94A5A,#ED6F7A,#F6B7BD,#F9F081,#F7E82D,#B8AE23,#334064,#4D6095,#6680C7",this.name="country",this.countryName=u(this.name),this.useTheme=!1,this.showLabels=!0,this.theme="light",this.country=null,this.svg=null,this.chart=null}countrySelected(t){t.detail&&t.detail.filter&&t.detail.filter==this.name&&(this.countryName=t.detail.value)}async componentWillLoad(){this.countryName=u(this.name)||this.countryName,this.dataSrc&&(this.data=await s(this.dataSrc))}componentWillRender(){this.countryName&&this.data&&(this.country=this.prepareData(this.countryName))}componentWillUpdate(){}componentDidUpdate(){this.update()}componentDidLoad(){this.chartElement=this.element.shadowRoot.getElementById("chart"),this.draw()}getCountry(t){return this.data.get({country:t})[0]}prepareData(t){if(this.countryName){let n=this.data.keyList(this.keys);return this.getCountry(t).filter(n).items}return null}update(){this.element.shadowRoot.getElementById("svg-container")?this.svg.selectAll(".radial-container").data(this.country,(function(t){return t.key})).call(this.chart):this.draw()}draw(){if(!this.country||0===this.country.length)return!1;this.element.shadowRoot.getElementById("placeholder")&&this.element.shadowRoot.getElementById("placeholder").remove();let t=this.colours.split(",").map((t=>t.trim())),n=M().range(t).domain(this.country.map((function(t){return t.key}))),r=h(this.chartElement).append("svg").attr("id","svg-container").attr("class","svg-container").attr("viewBox","0 0 600 320").append("g").attr("class","svg-group").attr("transform","translate(300,160)");for(let t=.1;t<=1;t+=.1)r.append("circle").attr("r",140*t);let i=r.selectAll("g").data(this.country,(function(t){return t.key}));this.chart=function(){let t=!0,n=null,r=!0,i=null,u=null,s=null;function h(u){let h=c().range([0,140]).domain([0,100]),a=function(r){return t&&o(i.getPillar(r.key))||n(r.key)},l=function(t){let n=i.getPillar(t.key)||"none";return n=n.toLowerCase().replaceAll(" ","-"),"wedge pillar-"+n},f=function(t){return t.key+": "+e(t.value,2)},d=function(){var t=W,n=U,r=w(0),i=null,e=Z,o=q,u=H,s=null;function h(){var h,a,c=+t.apply(this,arguments),l=+n.apply(this,arguments),f=e.apply(this,arguments)-T,d=o.apply(this,arguments)-T,p=D(d-f),v=d>f;if(s||(s=h=k()),l<c&&(a=l,l=c,c=a),l>1e-12)if(p>B-1e-12)s.moveTo(l*_(f),l*F(f)),s.arc(0,0,l,f,d,!v),c>1e-12&&(s.moveTo(c*_(d),c*F(d)),s.arc(0,0,c,d,f,v));else{var M,g,m=f,b=d,y=f,x=d,w=p,j=p,W=u.apply(this,arguments)/2,U=W>1e-12&&(i?+i.apply(this,arguments):L(c*c+l*l)),Z=E(D(l-c)/2,+r.apply(this,arguments)),q=Z,H=Z;if(U>1e-12){var Q=S(U/c*F(W)),R=S(U/l*F(W));(w-=2*Q)>1e-12?(y+=Q*=v?1:-1,x-=Q):(w=0,y=x=(f+d)/2),(j-=2*R)>1e-12?(m+=R*=v?1:-1,b-=R):(j=0,m=b=(f+d)/2)}var G=l*_(m),I=l*F(m),J=c*_(x),K=c*F(x);if(Z>1e-12){var N,V=l*_(b),X=l*F(b),Y=c*_(y),$=c*F(y);if(p<C&&(N=O(G,I,Y,$,V,X,J,K))){var tt=G-N[0],nt=I-N[1],rt=V-N[0],it=X-N[1],et=1/F(z((tt*rt+nt*it)/(L(tt*tt+nt*nt)*L(rt*rt+it*it)))/2),ot=L(N[0]*N[0]+N[1]*N[1]);q=E(Z,(c-ot)/(et-1)),H=E(Z,(l-ot)/(et+1))}}j>1e-12?H>1e-12?(M=P(Y,$,G,I,l,H,v),g=P(V,X,J,K,l,H,v),s.moveTo(M.cx+M.x01,M.cy+M.y01),H<Z?s.arc(M.cx,M.cy,H,A(M.y01,M.x01),A(g.y01,g.x01),!v):(s.arc(M.cx,M.cy,H,A(M.y01,M.x01),A(M.y11,M.x11),!v),s.arc(0,0,l,A(M.cy+M.y11,M.cx+M.x11),A(g.cy+g.y11,g.cx+g.x11),!v),s.arc(g.cx,g.cy,H,A(g.y11,g.x11),A(g.y01,g.x01),!v))):(s.moveTo(G,I),s.arc(0,0,l,m,b,!v)):s.moveTo(G,I),c>1e-12&&w>1e-12?q>1e-12?(M=P(J,K,V,X,c,-q,v),g=P(G,I,Y,$,c,-q,v),s.lineTo(M.cx+M.x01,M.cy+M.y01),q<Z?s.arc(M.cx,M.cy,q,A(M.y01,M.x01),A(g.y01,g.x01),!v):(s.arc(M.cx,M.cy,q,A(M.y01,M.x01),A(M.y11,M.x11),!v),s.arc(0,0,c,A(M.cy+M.y11,M.cx+M.x11),A(g.cy+g.y11,g.cx+g.x11),v),s.arc(g.cx,g.cy,q,A(g.y11,g.x11),A(g.y01,g.x01),!v))):s.arc(0,0,c,x,y,v):s.lineTo(J,K)}else s.moveTo(0,0);if(s.closePath(),h)return s=null,h+""||null}return h.centroid=function(){var r=(+t.apply(this,arguments)+ +n.apply(this,arguments))/2,i=(+e.apply(this,arguments)+ +o.apply(this,arguments))/2-C/2;return[_(i)*r,F(i)*r]},h.innerRadius=function(n){return arguments.length?(t="function"==typeof n?n:w(+n),h):t},h.outerRadius=function(t){return arguments.length?(n="function"==typeof t?t:w(+t),h):n},h.cornerRadius=function(t){return arguments.length?(r="function"==typeof t?t:w(+t),h):r},h.padRadius=function(t){return arguments.length?(i=null==t?null:"function"==typeof t?t:w(+t),h):i},h.startAngle=function(t){return arguments.length?(e="function"==typeof t?t:w(+t),h):e},h.endAngle=function(t){return arguments.length?(o="function"==typeof t?t:w(+t),h):o},h.padAngle=function(t){return arguments.length?(u="function"==typeof t?t:w(+t),h):u},h.context=function(t){return arguments.length?(s=null==t?null:t,h):s},h}().innerRadius(0).outerRadius((function(t){return h(e(t.value,2))})).startAngle((function(t){return s(t.key)})).endAngle((function(t){return s(t.key)+s.bandwidth()})).padAngle(.001).padRadius(0),p=function(t){return t.key+": "},v=function(t){return e(t.value,2)},M=function(t){t.selectAll(".label-container").remove(),t.append("g").attr("class","label-container").attr("tabindex",0).attr("text-anchor",(function(t){return(s(t.key)+s.bandwidth()/2+Math.PI)%(2*Math.PI)<Math.PI?"end":"start"})).attr("transform",(function(t){return"rotate("+(180*(s(t.key)+s.bandwidth()/2)/Math.PI-90)+")translate(150,0)"})).append("text").text(p).attr("transform",(function(t){return(s(t.key)+s.bandwidth()/2+Math.PI)%(2*Math.PI)<Math.PI?"rotate("+(180-(180*(s(t.key)+s.bandwidth()/2)/Math.PI-90)-180).toString()+")":"rotate("+(0-(180*(s(t.key)+s.bandwidth()/2)/Math.PI-90)-0).toString()+")"})).attr("class","label").attr("alignment-baseline","middle").append("tspan").attr("class","label-value").text(v).attr("alignment-baseline","middle")};u.join((t=>function(t){const n=t.append("g").attr("class","radial-container").attr("id",(function(t){return t.key}));return n.append("path").attr("fill",a).attr("class",l).attr("d",d).append("title").text(f).attr("aria-label",f),r&&M(n),n}(t)),(t=>function(t){return t.select("path").transition().duration(1e3).attr("d",d).select("title").text(f).attr("aria-label",f),r&&M(t),t}(t)))}return h.model=function(t){return arguments.length?(i=t,h):i},h.useTheme=function(n){return arguments.length?(t=n,h):t},h.keyList=function(t){return arguments.length?(u=t,s=g().range([0,2*Math.PI]).align(0).domain(u),h):u},h.colours=function(t){return arguments.length?(n=t,h):n},h.showLabels=function(t){return arguments.length?(r=t,h):r},h}().model(this.data).useTheme(this.useTheme).keyList(this.data.keyList(this.keys)).colours(n).showLabels(this.showLabels),i.call(this.chart),this.svg=r}render(){return n(r,{class:this.theme},n("div",{class:this.theme},n("div",{id:"chart",tabindex:"0"}),n("div",{id:"placeholder"},n("slot",null))))}get element(){return i(this)}};Q.style=":host{display:block;align-items:center;width:100%;background-color:var(--background-color);color:var(--text-color)}text.label{fill:var(--text-color)}.label{font-size:0.8rem}.label-value{font-weight:bold}path:hover{stroke-width:1px;stroke:white}circle{fill:none;stroke:#DDDDDD}#chart{margin:10px}:focus{outline:none;text-decoration:underline}#placeholder{background-color:var(--neutral-background-color);width:100%;text-align:center;padding-top:20px;padding-bottom:20px;font-size:1rem;font-weight:lighter;color:var(--text-color)}.dark{background-color:var(--primary-color);color:var(--light-color)}.dark text.label{fill:var(--light-color)}.dark circle{stroke:var(--secondary-color)}";export{Q as oi_radial_barchart}