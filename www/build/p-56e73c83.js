var t="http://www.w3.org/1999/xhtml";const n={svg:"http://www.w3.org/2000/svg",xhtml:t,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function r(t){var r=t+="",i=r.indexOf(":");return i>=0&&"xmlns"!==(r=t.slice(0,i))&&(t=t.slice(i+1)),n.hasOwnProperty(r)?{space:n[r],local:t}:t}function i(n){return function(){var r=this.ownerDocument,i=this.namespaceURI;return i===t&&r.documentElement.namespaceURI===t?r.createElement(n):r.createElementNS(i,n)}}function e(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function s(t){var n=r(t);return(n.local?e:i)(n)}function u(){}function o(t){return null==t?u:function(){return this.querySelector(t)}}function h(){return[]}function c(t){return null==t?h:function(){return this.querySelectorAll(t)}}function f(t){return function(){return this.matches(t)}}function a(t){return new Array(t.length)}function l(t,n){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=n}function v(t,n,r,i,e,s){for(var u,o=0,h=n.length,c=s.length;o<c;++o)(u=n[o])?(u.__data__=s[o],i[o]=u):r[o]=new l(t,s[o]);for(;o<h;++o)(u=n[o])&&(e[o]=u)}function w(t,n,r,i,e,s,u){var o,h,c,f={},a=n.length,v=s.length,w=new Array(a);for(o=0;o<a;++o)(h=n[o])&&(w[o]=c="$"+u.call(h,h.__data__,o,n),c in f?e[o]=h:f[c]=h);for(o=0;o<v;++o)(h=f[c="$"+u.call(t,s[o],o,s)])?(i[o]=h,h.__data__=s[o],f[c]=null):r[o]=new l(t,s[o]);for(o=0;o<a;++o)(h=n[o])&&f[w[o]]===h&&(e[o]=h)}function y(t,n){return t<n?-1:t>n?1:t>=n?0:NaN}function d(t){return function(){this.removeAttribute(t)}}function p(t){return function(){this.removeAttributeNS(t.space,t.local)}}function m(t,n){return function(){this.setAttribute(t,n)}}function g(t,n){return function(){this.setAttributeNS(t.space,t.local,n)}}function A(t,n){return function(){var r=n.apply(this,arguments);null==r?this.removeAttribute(t):this.setAttribute(t,r)}}function x(t,n){return function(){var r=n.apply(this,arguments);null==r?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,r)}}function b(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function F(t){return function(){this.style.removeProperty(t)}}function O(t,n,r){return function(){this.style.setProperty(t,n,r)}}function D(t,n,r){return function(){var i=n.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,r)}}function E(t,n){return t.style.getPropertyValue(n)||b(t).getComputedStyle(t,null).getPropertyValue(n)}function N(t){return function(){delete this[t]}}function j(t,n){return function(){this[t]=n}}function S(t,n){return function(){var r=n.apply(this,arguments);null==r?delete this[t]:this[t]=r}}function B(t){return t.trim().split(/^|\s+/)}function _(t){return t.classList||new k(t)}function k(t){this._node=t,this._names=B(t.getAttribute("class")||"")}function L(t,n){for(var r=_(t),i=-1,e=n.length;++i<e;)r.add(n[i])}function C(t,n){for(var r=_(t),i=-1,e=n.length;++i<e;)r.remove(n[i])}function I(t){return function(){L(this,t)}}function R(t){return function(){C(this,t)}}function G(t,n){return function(){(n.apply(this,arguments)?L:C)(this,t)}}function P(){this.textContent=""}function M(t){return function(){this.textContent=t}}function T(t){return function(){var n=t.apply(this,arguments);this.textContent=null==n?"":n}}function W(){this.innerHTML=""}function $(t){return function(){this.innerHTML=t}}function q(t){return function(){var n=t.apply(this,arguments);this.innerHTML=null==n?"":n}}function J(){this.nextSibling&&this.parentNode.appendChild(this)}function z(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function H(){return null}function U(){var t=this.parentNode;t&&t.removeChild(this)}function V(){var t=this.cloneNode(!1),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}function X(){var t=this.cloneNode(!0),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}l.prototype={constructor:l,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,n){return this._parent.insertBefore(t,n)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}},k.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var n=this._names.indexOf(t);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var K={},Q=null;function Y(t,n,r){return t=Z(t,n,r),function(n){var r=n.relatedTarget;r&&(r===this||8&r.compareDocumentPosition(this))||t.call(this,n)}}function Z(t,n,r){return function(i){var e=Q;Q=i;try{t.call(this,this.__data__,n,r)}finally{Q=e}}}function tt(t){return t.trim().split(/^|\s+/).map((function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}}))}function nt(t){return function(){var n=this.__on;if(n){for(var r,i=0,e=-1,s=n.length;i<s;++i)r=n[i],t.type&&r.type!==t.type||r.name!==t.name?n[++e]=r:this.removeEventListener(r.type,r.listener,r.capture);++e?n.length=e:delete this.__on}}}function rt(t,n,r){var i=K.hasOwnProperty(t.type)?Y:Z;return function(e,s,u){var o,h=this.__on,c=i(n,s,u);if(h)for(var f=0,a=h.length;f<a;++f)if((o=h[f]).type===t.type&&o.name===t.name)return this.removeEventListener(o.type,o.listener,o.capture),this.addEventListener(o.type,o.listener=c,o.capture=r),void(o.value=n);this.addEventListener(t.type,c,r),o={type:t.type,name:t.name,value:n,listener:c,capture:r},h?h.push(o):this.__on=[o]}}function it(t,n,r){var i=b(t),e=i.CustomEvent;"function"==typeof e?e=new e(n,r):(e=i.document.createEvent("Event"),r?(e.initEvent(n,r.bubbles,r.cancelable),e.detail=r.detail):e.initEvent(n,!1,!1)),t.dispatchEvent(e)}function et(t,n){return function(){return it(this,t,n)}}function st(t,n){return function(){return it(this,t,n.apply(this,arguments))}}"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(K={mouseenter:"mouseover",mouseleave:"mouseout"}));var ut=[null];function ot(t,n){this._groups=t,this._parents=n}function ht(){return new ot([[document.documentElement]],ut)}function ct(t){return"string"==typeof t?new ot([[document.querySelector(t)]],[document.documentElement]):new ot([[t]],ut)}function ft(t,n=3){let r=Number(t);return isNaN(r)?t:r%1==0?r.toFixed(0):lt(t,n)}function at(t){let n=Number(t);return isNaN(n)?t:n%1==0?n.toFixed(0):lt(t,2)}function lt(t,n){let r;try{r=parseFloat(t)}catch(n){return t}return isNaN(r)?t:r.toFixed(n)}function vt(t){return new URLSearchParams(window.location.search).get(t)}function wt(t,n="normal"){t=t.toLowerCase().replace(/\s/g,"-");let r={darkest:{"educational-readiness":"#536B35","learner-experience":"#291E44","policy-readiness":"#136664","technology-readiness":"#600B4E","service-experience":"#3A191D",overall:"#385cbf"},dark:{"educational-readiness":"#719148","learner-experience":"#3f306a","policy-readiness":"#1a8b89","technology-readiness":"#86106c","service-experience":"#ae4a56",overall:"#385cbf"},normal:{"educational-readiness":"#96c160","learner-experience":"#7e60d4","policy-readiness":"#23b9b6","technology-readiness":"#b31590","service-experience":"#e86372",overall:"#4b7aff"},light:{"educational-readiness":"#B3E874","learner-experience":"#9570F9","policy-readiness":"#2AE0DD","technology-readiness":"#D81AAF","service-experience":"#FF6D7E",overall:"#9eb7ff"},lightest:{"educational-readiness":"#C5FF7F","learner-experience":"#9872FF","policy-readiness":"#30FFFB","technology-readiness":"#FF1ECE","service-experience":"#FF6D96",overall:"#9eb7ff"}}[n];return t in r?r[t]:"#6D88A3"}function yt(t,n){var r;if(/^#([A-Fa-f0-9]{3}){1,2}$/.test(t))return 3==(r=t.substring(1).split("")).length&&(r=[r[0],r[0],r[1],r[1],r[2],r[2]]),"rgba("+[(r="0x"+r.join(""))>>16&255,r>>8&255,255&r].join(",")+","+n+")";throw new Error("Bad Hex")}function dt(t,n){return function(){for(var r=ct(this),i=r.text().length,e=r.text();i>t-2*n&&e.length>0;)e=e.slice(0,-1),r.text(e+"â€¦"),i=r.text().length}}ot.prototype=ht.prototype={constructor:ot,select:function(t){"function"!=typeof t&&(t=o(t));for(var n=this._groups,r=n.length,i=new Array(r),e=0;e<r;++e)for(var s,u,h=n[e],c=h.length,f=i[e]=new Array(c),a=0;a<c;++a)(s=h[a])&&(u=t.call(s,s.__data__,a,h))&&("__data__"in s&&(u.__data__=s.__data__),f[a]=u);return new ot(i,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=c(t));for(var n=this._groups,r=n.length,i=[],e=[],s=0;s<r;++s)for(var u,o=n[s],h=o.length,f=0;f<h;++f)(u=o[f])&&(i.push(t.call(u,u.__data__,f,o)),e.push(u));return new ot(i,e)},filter:function(t){"function"!=typeof t&&(t=f(t));for(var n=this._groups,r=n.length,i=new Array(r),e=0;e<r;++e)for(var s,u=n[e],o=u.length,h=i[e]=[],c=0;c<o;++c)(s=u[c])&&t.call(s,s.__data__,c,u)&&h.push(s);return new ot(i,this._parents)},data:function(t,n){if(!t)return d=new Array(this.size()),f=-1,this.each((function(t){d[++f]=t})),d;var r,i=n?w:v,e=this._parents,s=this._groups;"function"!=typeof t&&(r=t,t=function(){return r});for(var u=s.length,o=new Array(u),h=new Array(u),c=new Array(u),f=0;f<u;++f){var a=e[f],l=s[f],y=l.length,d=t.call(a,a&&a.__data__,f,e),p=d.length,m=h[f]=new Array(p),g=o[f]=new Array(p);i(a,l,m,g,c[f]=new Array(y),d,n);for(var A,x,b=0,F=0;b<p;++b)if(A=m[b]){for(b>=F&&(F=b+1);!(x=g[F])&&++F<p;);A._next=x||null}}return(o=new ot(o,e))._enter=h,o._exit=c,o},enter:function(){return new ot(this._enter||this._groups.map(a),this._parents)},exit:function(){return new ot(this._exit||this._groups.map(a),this._parents)},join:function(t,n,r){var i=this.enter(),e=this,s=this.exit();return i="function"==typeof t?t(i):i.append(t+""),null!=n&&(e=n(e)),null==r?s.remove():r(s),i&&e?i.merge(e).order():e},merge:function(t){for(var n=this._groups,r=t._groups,i=n.length,e=Math.min(i,r.length),s=new Array(i),u=0;u<e;++u)for(var o,h=n[u],c=r[u],f=h.length,a=s[u]=new Array(f),l=0;l<f;++l)(o=h[l]||c[l])&&(a[l]=o);for(;u<i;++u)s[u]=n[u];return new ot(s,this._parents)},order:function(){for(var t=this._groups,n=-1,r=t.length;++n<r;)for(var i,e=t[n],s=e.length-1,u=e[s];--s>=0;)(i=e[s])&&(u&&4^i.compareDocumentPosition(u)&&u.parentNode.insertBefore(i,u),u=i);return this},sort:function(t){function n(n,r){return n&&r?t(n.__data__,r.__data__):!n-!r}t||(t=y);for(var r=this._groups,i=r.length,e=new Array(i),s=0;s<i;++s){for(var u,o=r[s],h=o.length,c=e[s]=new Array(h),f=0;f<h;++f)(u=o[f])&&(c[f]=u);c.sort(n)}return new ot(e,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),n=-1;return this.each((function(){t[++n]=this})),t},node:function(){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],e=0,s=i.length;e<s;++e){var u=i[e];if(u)return u}return null},size:function(){var t=0;return this.each((function(){++t})),t},empty:function(){return!this.node()},each:function(t){for(var n=this._groups,r=0,i=n.length;r<i;++r)for(var e,s=n[r],u=0,o=s.length;u<o;++u)(e=s[u])&&t.call(e,e.__data__,u,s);return this},attr:function(t,n){var i=r(t);if(arguments.length<2){var e=this.node();return i.local?e.getAttributeNS(i.space,i.local):e.getAttribute(i)}return this.each((null==n?i.local?p:d:"function"==typeof n?i.local?x:A:i.local?g:m)(i,n))},style:function(t,n,r){return arguments.length>1?this.each((null==n?F:"function"==typeof n?D:O)(t,n,null==r?"":r)):E(this.node(),t)},property:function(t,n){return arguments.length>1?this.each((null==n?N:"function"==typeof n?S:j)(t,n)):this.node()[t]},classed:function(t,n){var r=B(t+"");if(arguments.length<2){for(var i=_(this.node()),e=-1,s=r.length;++e<s;)if(!i.contains(r[e]))return!1;return!0}return this.each(("function"==typeof n?G:n?I:R)(r,n))},text:function(t){return arguments.length?this.each(null==t?P:("function"==typeof t?T:M)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?W:("function"==typeof t?q:$)(t)):this.node().innerHTML},raise:function(){return this.each(J)},lower:function(){return this.each(z)},append:function(t){var n="function"==typeof t?t:s(t);return this.select((function(){return this.appendChild(n.apply(this,arguments))}))},insert:function(t,n){var r="function"==typeof t?t:s(t),i=null==n?H:"function"==typeof n?n:o(n);return this.select((function(){return this.insertBefore(r.apply(this,arguments),i.apply(this,arguments)||null)}))},remove:function(){return this.each(U)},clone:function(t){return this.select(t?X:V)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,n,r){var i,e,s=tt(t+""),u=s.length;if(!(arguments.length<2)){for(o=n?rt:nt,null==r&&(r=!1),i=0;i<u;++i)this.each(o(s[i],n,r));return this}var o=this.node().__on;if(o)for(var h,c=0,f=o.length;c<f;++c)for(i=0,h=o[c];i<u;++i)if((e=s[i]).type===h.type&&e.name===h.name)return h.value},dispatch:function(t,n){return this.each(("function"==typeof n?st:et)(t,n))}};class pt{constructor(){this.key=null,this.value=null,this.keyCategory=null}fromTuple(t){this.key=t.key,this.value=t.value}asTuple(){let t={};return t[this.key]=this.value,t}}class mt{constructor(){this.items=[]}getItem(t){let n=this.items.filter((function(n){return n.key===t}));return 1===n.length?n[0]:null}get(t){let n=this.getItem(t);return n?n.value:null}filter(t){let n=this.items;this.items.length>0&&(n=this.items.filter((function(n){return t.includes(n.key)})));let r=new mt;return r.items=n,r}contains(t){return 0!==this.items.filter((function(n){return n.key===t.key&&(n.value===t.value||"*any"===t.value)})).length}asObject(){let t={};for(let n=0;n<this.items.length;n++)t[this.items[n].key]=this.items[n].value;return t}fromObject(t){let n=this.reshapeData(t,null);for(let t=0;t<n.length;t++){let r=new pt;r.fromTuple(n[t]),this.items.push(r)}}reshapeData(t,n){let r=Object.entries(t).map((([t,n])=>({key:t,value:n})));return n&&(r=r.filter((function(t){return n.includes(t.key)}))),r}}class gt{constructor(t,n=null,r=null,i=null){this.source_data=null,this.data=null,this.sourceDataType=null,this.group=null,this.mappings={},this.keys=null,this.keyCategories=null,this.metadata={},this.source_data=t,this.sourceDataType=n,this.group=r,this.mappings=i,this.keys=new Set,this.keyCategories=new Set,this.createInternalRepresentation()}createInternalRepresentation(){this.data=[],this.sourceDataType||this.detectDataStructure(),"WIDE"===this.sourceDataType?this.importWideData():"LONG"===this.sourceDataType?this.importLongData():this.importGeoJSONData()}detectDataStructure(){if("features"in this.source_data)this.sourceDataType="GEOJSON";else if("value"in this.source_data[0]){let t=Object.keys(this.source_data[0]);this.sourceDataType="LONG",this.mappings={},this.mappings.value="value",t=xt(t,"value"),"Country"in this.source_data[0]?(this.group="Country",t=xt(t,"Country")):"country"in this.source_data[0]&&(this.group="country",t=xt(t,"country")),"indicator"in this.source_data[0]&&(this.mappings.key="indicator",t=xt(t,"indicator")),"measure"in this.source_data[0]&&(this.mappings.key="measure",t=xt(t,"measure")),"pillar"in this.source_data[0]&&(this.mappings.keyCategory="pillar",t=xt(t,"pillar")),"category"in this.source_data[0]&&(this.mappings.keyCategory="category",t=xt(t,"category")),this.group||(this.group=t.pop())}else this.sourceDataType="WIDE"}importWideData(){for(let t=0;t<this.source_data.length;t++){let n=new mt;n.fromObject(this.source_data[t]),this.data.push(n)}}importLongData(){let t=[];for(let n=0;n<this.source_data.length;n++)t.includes(this.source_data[n][this.group])||t.push(this.source_data[n][this.group]);let n=[];for(let r=0;r<t.length;r++){let i=new mt,e=new pt;e.key=this.group,e.value=t[r],i.items.push(e),n.push(i)}let r=Object.keys(this.source_data[0]),i=Object.values(this.mappings);r=xt(r,this.group),r=r.filter((function(t){return-1===i.indexOf(t)}));for(let t=0;t<this.source_data.length;t++){let r=this.source_data[t],i=new pt;i.key=r[this.mappings.key],i.value=r[this.mappings.value],i.keyCategory=r[this.mappings.keyCategory],i.key===i.keyCategory&&"Overall"!==i.key||(this.metadata[i.key]=i.keyCategory,this.keys.add(i.key),this.keyCategories.add(i.keyCategory));let e=r[this.group];for(let t=0;t<n.length;t++)n[t].get(this.group)==e&&n[t].items.push(i)}for(let t=0;t<n.length;t++){let i=n[t],e=[];for(let t=0;t<r.length;t++){let n=new pt;n.key=r[t];let s=this.group,u=i.get(this.group),o=this.source_data.filter((function(t){return t[s]==u}));n.value=o[0][r[t]],n.keyCategory="dimensions",e.push(n)}i.items=i.items.concat(e)}this.data=n}importGeoJSONData(){let t=this.source_data.features;for(let n=0;n<t.length;n++){let r=new mt;r.fromObject(t[n].properties),this.data.push(r)}}getPillar(t){return t in this.metadata?this.metadata[t]:Object.values(this.metadata).includes(t)?t:null}keyList(t,n=null){if(!t)return[];let r=t.split(",").map((t=>t.trim())),i=r.indexOf("@pillars"),e=r.indexOf("@indicators"),s=r.indexOf("@overall");if(-1!==i){let t=Array.from(this.keyCategories).sort(gt.sortByPillar);r.splice(i,1,...t)}if(-1!==s&&n&&r.splice(s,1,n),-1!==e)if(n){let t=[];for(const[r,i]of Object.entries(this.metadata))i===n&&t.push(r);r.splice(e,1,...Array.from(t))}else{let t=Array.from(this.keyCategories).sort(gt.sortByPillar),n=Array.from(this.keys),i=[];for(let r=0;r<t.length;r++)for(let e=0;e<n.length;e++)this.metadata[n[e]]===t[r]&&i.push(n[e]);r.splice(e,1,...i)}return r}static sortByPillar(t,n){let r={"Service experience":5,"Technology Readiness":4,"Policy Readiness":3,"Learner Experience":2,"Educational Readiness":1,Overall:0};return r[t]&&(t=r[t]),r[n]&&(n=r[n]),t-n}static getDataItemFilter(t){let n=new mt;return n.fromObject(t),n}get(t={}){return this.filterByMatchingItems(this.data,gt.getDataItemFilter(t))||null}getOne(t={}){let n=this.get(t);return 1===n.length?n[0].asObject():null}getValues(t){let n=[];for(let r=0;r<this.data.length;r++)n.push(this.data[r].get(t));return n}filterByMatchingItems(t,n){return t.filter((function(t){for(let r=0;r<n.items.length;r++)if(!t.contains(n.items[r]))return!1;return!0}))}}async function At(t){const n="data-model-3";return t?"caches"in window?(await async function(){const t=await caches.keys();for(const n of t){const t=n.startsWith("data-model-");"data-model-3"!==n&&t&&await caches.delete(n)}}(),caches.open(n).then((n=>n.match(t).then((r=>r?r.json().then((t=>new gt(t))):fetch(t,{mode:"cors"}).then((r=>{let i=r.clone();return r.json().then((r=>(n.put(t,i),new gt(r))))}))))))):fetch(t).then((t=>t.json())).then((t=>new gt(t))):null}function xt(t,n){return t.filter((t=>t!==n))}export{wt as a,o as b,c,ht as d,E as e,at as f,vt as g,Q as h,ft as i,yt as j,lt as k,At as l,f as m,r as n,ct as s,dt as w}